# Сценарии вариантов использования и пользовательские требования (общая часть)

## **Сценарий:** обработка пользовательского запроса и выдача маршрута по запросу.

**Основное действующее лицо:** пользователь.

**Область действия:** окно создания запроса

**Уровень:** пользовательский.

**Участники и интересы:** пользователь - хочет получить маршрут на карте по своему запросу Триггер: ввод пользователем запроса и подтверждение ввода (отправка на сервер).

**Основной сценарий:**

1. Пользователь заходит в приложение
2. У пользователя запрашивается разрешение на получение его координат
3. Пользователь вводит вопрос голосом либо текстом
4. Пользователь выбирает тип транспортного средства из предложенных
5. Пользователь подтверждает ввод и запрос, координаты и тип транспортного средства отправляются на сервер
6. Пользователь получает готовый маршрут на Яндекс.карте

**Расширения:**

2. а) Пользователь пытается отправить пустой запрос. Ему возвращается предупреждение, и запрос не отправляется.
3. а) Пользователь не выбирает тип ТС, в таком случае, если пользователь указал тип в запросе, он берется оттуда.
3. б) Пользователь не указывает тип ТС нигде, в таком случае считается, что он идет пешком.
3. в) Указан разный тип в запросе и в приложении, в таком случае приоритет отдается запросу.
4. а) Ответ с сервера не приходит, отображается сообщение об ошибке.
5. а) Пользователь при входе в приложение не даёт разрешения на определение, местоположения, отображается сообщение об ошибке, предлагается дать разрешение ещё раз.

## **Сценарий:** авторизация в приложении.

**Основное действующее лицо:** пользователь.

**Область действия:** окно авторизации

**Уровень:** пользовательский.

**Участники и интересы:** пользователь - хочет войти в профиль в приложении.

**Триггер:** переход пользователя на страницу входа в профиль, ввод пользователем номера телефона или email.

**Основной сценарий:**

1. Пользователь заходит в приложение и открывает страницу входа.
2. Пользователь вводит свой email или номер телефона.
3. Пользователь жмёт на кнопку «войти».
4. Пользователь подтверждает ввод и информация отправляется на сервер.
5. Открывается окно, в которое требуется ввести код авторизации.
6. На указанный email или телефон приходит одноразовый код авторизации.
7. Пользователь вводит его и получает доступ к своему аккаунту.
8. Восстанавливается история запросов и список понравившихся маршрутов.

**Расширения:**

2. а) Пользователь пытается ввести номер телефона или email в некорректном формате. Ему возвращается предупреждение, и запрос не отправляется.
2. б) Пользователь пытается ввести номер телефона или email, которых нет в базе данных пользователей. Для него создаётся новый профиль.
3. а) Пользователь вводит корректный номер телефона или email, к которым он не имеет доступа. По прошествии двух минут пользователю показывается ошибка «Время ожидания истекло» и становится активна кнопка «отправить код повторно»
4. а) Пользователь вводит неправильный код. Выводится ошибка, поле ввода кода сбрасывается

## **Сценарий:** сохранение понравившихся маршрутов

**Основное действующее лицо:** пользователь.

**Область действия:** окно просмотра результатов запроса, окно просмотра понравившихся маршрутов

**Уровень:** пользовательский.

**Участники и интересы:** пользователь - хочет сохранить понравившиеся маршруты, чтобы вернуться к ним позже Триггер: клик по иконке сердечка в правом верхнем углу карточки маршрута.

**Основной сценарий:**

1. Пользователь заходит в приложение и открывает окно просмотра результатов запроса
2. Пользователь кликает по иконке сердечка в правом верхнем углу карточки понравившегося маршрута.
3. Иконка сердечка становится красной.
4. Маршрут сохраняется в «понравившиеся» .
5. Пользователь открывает окно просмотра понравившихся маршрутов и видит сохранённые маршруты.
6. При клике на красную иконку сердечка маршрут убирается из списка понравившихся.

**Расширения:**

2. а) Пользователь открывает приложение на другом устройстве и успешно авторизуется там. Список понравившихся маршрутов восстанавливается

## **Сценарий:** просмотр истории маршрутов

**Основное действующее лицо:** пользователь.

**Область действия:** окно создания запроса, окно просмотра истории запросов, окно просмотра результатов запроса

**Уровень:** пользовательский.

**Участники и интересы:** пользователь хочет, чтобы была история запросов и их можно было быстро повторить Триггер: ввод пользователем запроса

**Основной сценарий:**
1. Пользователь заходит в приложение и успешно отправляет запрос
2. Спустя произвольное количество времени пользователь заходит в окно 
3. просмотра истории запросов и кликает по элементу истории
4. Осуществляется переход в окно просмотра результатов запроса
5. Отправляется запрос на сервер
6. Запрос приходит
7. Отображаются результаты запроса

**Расширения:**

2. а) Пользователь открывает приложение на другом устройстве и успешно авторизуется там. История запросов восстанавливается
3. а) Ответ с сервера не приходит, отображается сообщение об ошибке
4. а) Пользователь при запуске приложения не дал разрешения на получение геопозиции. Запрос не отправляется, отображается сообщение об ошибке.

## **Сценарий:** авторизация в приложении

**Основное действующее лицо:** пользователь.

**Область действия:** окно изменения профиля пользователя

**Уровень:** пользовательский.

**Участники и интересы:** пользователь – изменить свой профиль в приложении 

**Триггер:** переход пользователя на страницу редактирования профиля, нажатие на кнопку настроек в правом верхнем углу экрана

**Основной сценарий:**

1. Пользователь заходит в приложение и открывает окно изменения профиля пользователя
2. Пользователь жмёт на кнопку настроек в правом верхнем углу экрана
3. Пользователь меняет данные в полях ввода
4. Пользователь кликает по своему аватару. Открывается окно выбора фотографии. После выбора фотографии она ставится на аватар.
5. Пользователь жмёт на кнопку «Сохранить»
6. Новые данные учётной записи отправляются на сервер
7. Отображается сообщение об успешном изменении профиля пользователя
8. Страница изменения профиля переходит в режим просмотра профиля

**Расширения:**

2. а) Пользователь пытается ввести номер телефона или email в некорректном 
формате. Ему возвращается предупреждение, и запрос не отправляется.
3. а) С сервера не приходит ответ. Выводится ошибка.
4. а) Пользователь отправляет пустое имя пользователя. Выводится ошибка

# Сценарии вариантов использования (Python-часть)

## **Сценарий:** обработка пользовательского запроса и передача на вход следующему скрипту на Kotlin

**Основное действующее лицо:** пользователь.

**Область действия:** удаленный сервер.

**Уровень:** пользовательский.

## **Сценарий:** обработка пользовательского запроса и выдача маршрута по запросу.

**Участники и интересы:** пользователь - хочет получить маршрут на карте по 
своему запросу

**Триггер:** ввод пользователем запроса и подтверждение ввода (отправка на сервер).

**Основной сценарий:**

1. Пользователь заходит в приложение и авторизуется в нем
2. Пользователь вводит вопрос голосом либо текстом
3. Пользователь выбирает тип транспортного средства из предложенных
4. Пользователь подтверждает ввод и информация отправляется на сервер
5. Пользователь получает готовый маршрут на Яндекс.карте

**Расширения:**

2. а) Пользователь пытается отправить пустой запрос. Ему возвращается предупреждение, и запрос не отправляется.
3. а) Пользователь не выбирает тип ТС, в таком случае, если пользователь указал тип в запросе, он берется оттуда.
3. б) Пользователь не указывает тип ТС нигде, в таком случае считается, что он идет пешком.
3. в) Указан разный тип в запросе и в приложении, в таком случае приоритет отдается запросу

## **Сценарий:** обработка авторизации пользователя.

**Основное действующее лицо:** пользователь.

**Область действия:** удаленный сервер.

**Уровень:** пользовательский.

**Участники и интересы:** пользователь - хочет авторизоваться в приложении

**Триггер:** ввод пользователем email/телефона и подтверждение ввода (отправка на сервер).

**Основной сценарий:**

1. Пользователь заходит в приложение и авторизуется в нем
2. Запрос приходит на сервер
3. Сервер ищет email или телефон в базе данных. Если нет, то он готовится к созданию нового аккаунта.
4. Сервер генерирует отправляет код на номер телефона/email пользователя
5. Сервер отправляет результаты запроса на создание/вход в профиль пользователю
6. Сервер ждёт ввода кода со стороны пользователя.
7. После отправки кода он проверяет корректность кода и отправляет пользователю подтверждение авторизации
8. Если пользователь создал новый аккаунт, то сервер вносит в базу данных нового пользователя

**Расширения:**

2. а) Пользователь отправил неверный код. Отправляется сообщение об ошибке авторизации.
2. б) Пользователь долгое время не отправлял код. Прекращается ожидание ответа пользователя.

## **Сценарий:** обработка изменения профиля пользователя.

**Основное действующее лицо:** пользователь.

**Область действия:** удаленный сервер.

**Уровень:** пользовательский.

**Участники и интересы:** пользователь - хочет изменить свой профиль 

**Триггер:** ввод пользователем новых данных для профиля и отправка их на сервер вместе с id пользователя.

**Основной сценарий:**

1. Пользователь вводит новые пользовательские данные и отправляет на сервер
2. Запрос приходит на сервер
3. Сервер меняет данные пользователя с заданным id.
4. Сервер отправляет сообщение о корректном изменении данных профиля пользователю.

**Расширения:**
2. а) Id пользователя не найден. Отображается сообщение об ошибке.